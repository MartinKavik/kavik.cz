---
import Icon from './Icon.astro';
---

<footer>
	<div class="newsletter">
		<form class="newsletter-form" action="https://formsubmit.co/martin@kavik.cz" method="POST">
			<input type="hidden" name="_subject" value="Newsletter Subscription">
			<input type="hidden" name="_captcha" value="false">
			<input type="hidden" name="_template" value="table">
			<input type="hidden" name="_autoresponse" value="Thanks for subscribing! You'll receive occasional updates about new projects. You can unsubscribe anytime by replying to any email.">

			<div class="form-row">
				<label for="footer-email" class="sr-only">Email address</label>
				<input
					type="email"
					id="footer-email"
					name="email"
					class="email-input"
					placeholder="your@email.com"
					required
					autocomplete="email"
					data-1p-ignore
					data-lpignore="true"
					data-form-type="other"
				/>
				<button type="submit" class="subscribe-button">
					<span class="envelope-icon"><Icon icon="envelope-simple" size="1.4em" /></span>
					Subscribe
				</button>
			</div>

			<label class="consent-label">
				<input type="checkbox" name="consent" required />
				<span class="checkmark"></span>
				<span class="consent-text">I agree to receive emails. Unsubscribe anytime.</span>
			</label>
		</form>
	</div>

	<div class="footer-links">
		<a href="mailto:martin@kavik.cz">martin@kavik.cz</a>
		<a href="https://github.com/MartinKavik" aria-label="GitHub"><Icon icon="github-logo" size="1.4em" /></a>
		<a href="https://x.com/MartinKavik" aria-label="X"><Icon icon="x-logo" size="1.4em" /></a>
		<a href="https://www.youtube.com/@MartinKavik" aria-label="YouTube"><Icon icon="youtube-logo" size="1.4em" /></a>
	</div>
</footer>

<style>
	footer {
		display: flex;
		flex-direction: column;
		gap: 2.5rem;
		margin-top: auto;
		padding: 3.5rem 1.5rem;
		color: var(--gray-400);
		font-size: var(--text-sm);
		border-top: 1px solid var(--gray-800);
	}

	@media (min-width: 60em) {
		footer {
			flex-direction: row;
			justify-content: space-between;
			align-items: center;
			padding: 3.5rem 5rem;
		}
	}

	footer a {
		color: var(--gray-400);
		text-decoration: 1px solid underline transparent;
		text-underline-offset: 0.25em;
		transition: text-decoration-color var(--theme-transition);
	}

	footer a:hover,
	footer a:focus {
		text-decoration-color: currentColor;
	}

	/* Newsletter */
	.newsletter {
		display: flex;
		justify-content: center;
	}

	.newsletter-form {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 1rem;
		width: 100%;
		max-width: 26rem;
	}

	@media (min-width: 60em) {
		.newsletter {
			justify-content: flex-start;
		}

		.newsletter-form {
			align-items: flex-start;
		}
	}

	.form-row {
		display: flex;
		gap: 0.625rem;
		width: 100%;
	}

	.email-input {
		flex: 1;
		min-width: 0;
		padding: 0.75rem 1rem;
		font-size: var(--text-base, 1rem);
		font-family: inherit;
		background: var(--gray-800);
		border: 1px solid var(--gray-700);
		border-radius: 0.375rem;
		color: var(--gray-0);
		transition: border-color 0.2s ease;
	}

	.email-input:focus {
		outline: none;
		border-color: var(--accent-regular);
	}

	.email-input::placeholder {
		color: var(--gray-500);
	}

	.subscribe-button {
		position: relative;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 0.5em;
		padding: 0.75rem 1.25rem 0.75rem 1rem;
		font-size: var(--text-base, 1rem);
		font-family: inherit;
		color: var(--gray-0);
		background: var(--gray-800);
		border: none;
		border-radius: 0.375rem;
		cursor: pointer;
		white-space: nowrap;
		transition: background 0.2s ease;
	}

	.subscribe-button::before {
		content: '';
		position: absolute;
		inset: 0;
		border-radius: 0.375rem;
		padding: 1.5px;
		background: var(--rainbow-gradient);
		background-size: 200% 100%;
		background-position: 60% 0;
		-webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
		mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
		-webkit-mask-composite: xor;
		mask-composite: exclude;
		pointer-events: none;
		opacity: 0.6;
		animation: rainbow-shift 8s linear infinite;
	}

	.subscribe-button:hover::before,
	.subscribe-button:focus::before {
		opacity: 1;
		animation: rainbow-shift 4s linear infinite;
	}

	.subscribe-button:hover,
	.subscribe-button:focus {
		background: var(--gray-700);
	}

	.envelope-icon {
		display: flex;
	}

	@keyframes rainbow-shift {
		0% { background-position: 0% 0; }
		100% { background-position: 200% 0; }
	}

	/* Checkbox */
	.consent-label {
		display: flex;
		align-items: center;
		gap: 0.625rem;
		cursor: pointer;
		font-size: var(--text-sm);
		color: var(--gray-500);
	}

	.consent-label input[type="checkbox"] {
		position: absolute;
		opacity: 0;
		width: 0;
		height: 0;
	}

	.checkmark {
		position: relative;
		flex-shrink: 0;
		width: 1.25rem;
		height: 1.25rem;
		background: var(--gray-800);
		border: 1.5px solid var(--gray-600);
		border-radius: 0.25rem;
		transition: all 0.2s ease;
	}

	.checkmark::after {
		content: '';
		position: absolute;
		left: 0.5rem;
		top: 0.19rem;
		width: 0.3rem;
		height: 0.6rem;
		border: solid white;
		border-width: 0 2px 2px 0;
		transform: rotate(45deg) scale(0);
		transition: transform 0.15s ease;
	}

	.consent-label input[type="checkbox"]:checked + .checkmark {
		background: linear-gradient(135deg, #2a9d8f, #3a86ff);
		border-color: transparent;
	}

	.consent-label input[type="checkbox"]:checked + .checkmark::after {
		transform: rotate(45deg) scale(1);
	}

	.consent-label:hover .checkmark {
		border-color: var(--gray-500);
	}

	/* Footer links */
	.footer-links {
		display: flex;
		justify-content: center;
		gap: 0.75rem;
	}

	.footer-links a {
		padding: 0.625rem 1rem;
		font-size: var(--text-base, 1rem);
		color: var(--gray-300);
		background: var(--gray-800);
		border-radius: 0.375rem;
		text-decoration: none;
		transition: background 0.2s ease, color 0.2s ease;
	}

	.footer-links a:hover,
	.footer-links a:focus {
		background: var(--gray-700);
		color: var(--gray-0);
		text-decoration: none;
	}

	.footer-links a:has(svg) {
		padding: 0.75rem;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.sr-only {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border: 0;
	}

</style>
